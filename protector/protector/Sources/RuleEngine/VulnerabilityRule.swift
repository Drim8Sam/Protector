import Foundation

/// Модель уязвимости
public struct Vulnerability: Codable, Hashable {
    public let file: String
    public let type: String
    public let line: Int
    public let severity: SeverityLevel

    public init(file: String, type: String, line: Int, severity: SeverityLevel = .medium) {
        self.file = file
        self.type = type
        self.line = line
        self.severity = severity
    }
}

/// Протокол для всех правил детекции уязвимостей
public protocol VulnerabilityRule {
    var id: String { get }
    func check(in file: ParsedFile) throws -> [Vulnerability]
}
